var PHOTOS_PER_PAGE=4;var WORDS_PER_DESC=16;function escapeHtml(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function trim(d,a){var c=d.split(" ");var b=d;if(c.length>a){b=c.slice(0,a).join(" ")+" …"}return b}function renderResponse(e,a,c){if(a==0){var b="<p>Brak wyników</p>"}else{var b="";$(e).each(function(g,f){b+='<div class="thumbnail">';b+='<p><img src="'+f.thumbnailFile+'"/></p>';b+='<div class="desc"><p>'+(f.description?escapeHtml(trim(f.description,WORDS_PER_DESC)):"<i>brak opisu</i>")+"</p>";b+='<p><a href="'+f.photoPage+'" class="with-icon icon-detail">Szczegóły</a></p></div>';b+="</div> "});b+="<p>";for(var d=1;d<=a;d++){if(d==c){b+="[Strona "+d+"] "}else{b+='[<a href="javascript: sendRequest('+d+')">Strona '+d+"</a>] "}}b+="</p>"}$("#results").html(b)}function sendRequest(a){query=$("#search-query").val();$.getJSON("/api/search",{q:query,o:(a-1)*PHOTOS_PER_PAGE,l:PHOTOS_PER_PAGE},function(b){pageCount=Math.ceil(b.totalFound/PHOTOS_PER_PAGE);renderResponse(b.photos,pageCount,a)})}$(function(){$("#search-form").submit(function(){sendRequest(1);return false})});